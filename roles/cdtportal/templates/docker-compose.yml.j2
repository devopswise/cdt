version: '2'
services:
  cdtportal:
    image: "{{ cdtportal_registry_url }}{{ cdtportal_image_name }}:{{ cdtportal_version }}"
    volumes:
      - "{{ docker_volumes }}/{{ cdtportal_service_name }}/config/application.yml:/config/application.yml"
      - "{{ docker_volumes }}/{{ cdtportal_service_name }}/data:/data"
      - "{{ docker_certs }}/cacerts:/etc/ssl/certs/java/cacerts:ro"
    environment:
      CDTPORTAL_DATA: "/data"
      CDTPORTAL_LOG: "/var/log/cdtportal"
    ports:
      - 8080
    networks:
      - internal
      - external
    restart: always
    labels:
      - traefik.backend=cdtportal
      - traefik.frontend.rule=Host:cdtportal.{{ base_domain }}
      - traefik.port=8080
    #logging:
    #  driver: "syslog"
    #  options:
    #    syslog-facility: "local2"
    #    tag: "docker/{% raw %}{{.Name}}{% endraw %}"

networks:
  internal:
    external: true
  external:
    external: true


